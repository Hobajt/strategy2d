cmake_minimum_required(VERSION 3.16)

#######################

option(ENGINE_ENABLE_LOGGING "Enables logging (writes to stderr)." ON)
option(ENGINE_ENABLE_ASSERTS "Enables custom assertion checks." ON)

#######################

set(VENDOR_DIR "${CMAKE_SOURCE_DIR}/vendor")

#generate config file
configure_file("engine_config.h.in" "include/engine/utils/engine_config.h" @ONLY)

add_library(${LIB_NAME}
"include/engine/engine.h" "src/tmp.cpp")

#==== library's include dir & config file generated by cmake ====
target_include_directories(${LIB_NAME} PUBLIC "${CMAKE_CURRENT_SOURCE_DIR}/include")
target_include_directories(${LIB_NAME} PUBLIC "${CMAKE_CURRENT_BINARY_DIR}/include")

#==== Glad ====
set(GLAD_DIR "${VENDOR_DIR}/glad")
target_include_directories(${LIB_NAME} PUBLIC "${GLAD_DIR}/include")
target_sources(${LIB_NAME} PRIVATE "${GLAD_DIR}/src/glad.cpp")

#==== GLFW ====
if(BUILD_GLFW_FROM_SOURCE)
    message(STATUS "===GLFW from source===")
    set(GLFW_BUILD_DOCS OFF CACHE BOOL "" FORCE)
    set(GLFW_BUILD_TESTS OFF CACHE BOOL "" FORCE)
    set(GLFW_BUILD_EXAMPLES OFF CACHE BOOL "" FORCE)
    add_subdirectory("${VENDOR_DIR}/glfw" "vendor/glfw")
else()
    message(STATUS "===GLFW from install===")
    find_package(glfw3 3.3 REQUIRED)
endif()
target_link_libraries(${LIB_NAME} glfw)

#==== GLM ====
target_include_directories(${LIB_NAME} PUBLIC "${VENDOR_DIR}/glm/include")

#==== stb_image ====
target_include_directories(${LIB_NAME} PUBLIC "${VENDOR_DIR}/stb_image/include")

#==== imgui ====
set(IMGUI_DIR "${VENDOR_DIR}/imgui")
target_include_directories(${LIB_NAME} PUBLIC "${IMGUI_DIR}/include")
target_sources(${LIB_NAME} PRIVATE 
    "${IMGUI_DIR}/src/imgui.cpp" "${IMGUI_DIR}/src/imgui_demo.cpp" "${IMGUI_DIR}/src/imgui_draw.cpp" "${IMGUI_DIR}/src/imgui_impl_glfw.cpp" 
    "${IMGUI_DIR}/src/imgui_impl_opengl3.cpp" "${IMGUI_DIR}/src/imgui_tables.cpp" "${IMGUI_DIR}/src/imgui_widgets.cpp"
)

#==== nlohmann/json ====
target_include_directories(${LIB_NAME} PUBLIC "${VENDOR_DIR}/nlohmann/json/include")

#==== FreeType ====
add_subdirectory("${VENDOR_DIR}/freetype" "vendor/freetype")
target_link_libraries(${LIB_NAME} freetype)
